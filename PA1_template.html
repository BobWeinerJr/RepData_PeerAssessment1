<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Bob Weiner" />

<meta name="date" content="2015-11-12" />

<title>Activity Monitoring</title>

<script src="PA1_template_files/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="PA1_template_files/bootstrap-3.3.1/css/bootstrap.min.css" rel="stylesheet" />
<script src="PA1_template_files/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="PA1_template_files/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="PA1_template_files/bootstrap-3.3.1/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="PA1_template_files/highlight/default.css"
      type="text/css" />
<script src="PA1_template_files/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">


<div id="header">
<h1 class="title">Activity Monitoring</h1>
<h4 class="author"><em>Bob Weiner</em></h4>
<h4 class="date"><em>November 12, 2015</em></h4>
</div>


<div id="introduction" class="section level3">
<h3>Introduction</h3>
<pre class="r"><code>suppressMessages({      # dplyr masks objects from other packages 
    library(stringr)
    library(dplyr)
})

# Constants
workingDir &lt;- &quot;C:/Users/Bob/Dropbox/School/Coursera/Reproducible Research/RepData_PeerAssessment1&quot;

histogram.cells = 15</code></pre>
</div>
<div id="loading-and-preprocessing" class="section level3">
<h3>Loading and Preprocessing</h3>
<pre class="r"><code># 1. Load the activity data
act &lt;- read.csv(
    file = unzip(
        zipfile = str_c(workingDir, &quot;/activity.zip&quot;), 
        files = &quot;activity.csv&quot;),
    stringsAsFactors = FALSE)

# 2. Transform data
act$date &lt;- as.Date(act$date)</code></pre>
</div>
<div id="mean-total-steps-per-day" class="section level3">
<h3>Mean Total Steps Per Day</h3>
<pre class="r"><code># 1. Calculate total steps per day
act.total.raw &lt;- act %&gt;% 
    group_by(date) %&gt;% 
    summarise(total = sum(steps, na.rm = T))

head(act.total.raw)</code></pre>
<pre><code>## Source: local data frame [6 x 2]
## 
##         date total
##       (date) (int)
## 1 2012-10-01     0
## 2 2012-10-02   126
## 3 2012-10-03 11352
## 4 2012-10-04 12116
## 5 2012-10-05 13294
## 6 2012-10-06 15420</code></pre>
<pre class="r"><code># 2. Create Histogram
hist (act.total.raw$total,
      breaks = seq(from = min(act.total.raw$total),
                   to =   max(act.total.raw$total), 
                   by = ( max(act.total.raw$total) -
                          min(act.total.raw$total)) / histogram.cells),
      main = &#39;Total Number of Steps Per Day&#39;,
      xlab = &#39;Steps&#39;
)</code></pre>
<div class="figure">
<img src="PA1_template_files/figure-html/unnamed-chunk-3-1.png" />
</div>
<pre class="r"><code># 3. Mean and median steps per day
act.mean.raw &lt;- mean(act.total.raw$total)
act.median.raw &lt;- median(act.total.raw$total)</code></pre>
</div>
<div id="average-daily-activity-pattern" class="section level3">
<h3>Average Daily Activity Pattern</h3>
<pre class="r"><code># 1. Time series plot of 5-min interval and average steps
#   Average Daily Pattern
adp = act %&gt;% 
    group_by(interval) %&gt;% 
    summarise(meanSteps = mean(steps, na.rm = T))

#   Plot pattern
plot(adp$interval,
     adp$meanSteps,
     type = &#39;l&#39;,
     main = &#39;Average Daily Pattern&#39;,
     xlab = &#39;Interval of Day&#39;,
     ylab = &#39;Mean Number of Steps&#39;,
     xaxt = &#39;n&#39;)

#   Add x-axis tick marks at every 2 hours
ticks.num &lt;- 12
ticks &lt;- adp$interval[0:(ticks.num-1) * (nrow(df)/ticks.num) + 1]
axis(side = 1, at = ticks)</code></pre>
<div class="figure">
<img src="PA1_template_files/figure-html/unnamed-chunk-4-1.png" />
</div>
<pre class="r"><code># 2. Max number of interval steps
max(adp$meanSteps)</code></pre>
<pre><code>## [1] 206.1698</code></pre>
</div>
<div id="imputing-missing-values" class="section level3">
<h3>Imputing Missing Values</h3>
<pre class="r"><code># 1. Total number of rows with NAs
steps.missing = sum(is.na(act$steps))

# 2. Filling in missing values from adp and
# 3. Create a new dataset
newAct &lt;- act %&gt;% 
    inner_join(adp, by = &#39;interval&#39;) %&gt;%
    mutate(steps = ifelse(is.na(steps),
                          meanSteps,
                          steps)) %&gt;%
    select(steps:interval)

# 4a. Histogram of total steps per day
act.total.imputed &lt;- newAct %&gt;% 
    group_by(date) %&gt;% 
    summarise(total = sum(steps, na.rm = T))
    
hist(act.total.imputed$total,
     breaks = seq(from = min(act.total.imputed$total),
                  to =   max(act.total.imputed$total), 
                  by = ( max(act.total.imputed$total) -
                             min(act.total.imputed$total)) / histogram.cells),
     main = &#39;Total Number of Steps Per Day&#39;,
     xlab = &#39;Steps&#39;
)  </code></pre>
<div class="figure">
<img src="PA1_template_files/figure-html/unnamed-chunk-5-1.png" />
</div>
<pre class="r"><code># 4b. Mean and median of total steps per day
act.mean.imputed &lt;- mean(act.total.imputed$total)
act.median.imputed &lt;- median(act.total.imputed$total)

# 4c. Compare mean and median with and without imputed values 
matrix(
    c(act.mean.raw,     
      act.median.raw, 
      abs(act.mean.imputed - act.mean.raw) / act.mean.raw,
      
      act.mean.imputed, 
      act.median.imputed, 
      abs(act.median.imputed - act.median.raw) / act.median.raw), 
    nrow = 3, 
    dimnames = list(
        c(&#39;Raw&#39;,  &#39;Imputed&#39;, &#39;% Change&#39;),
        c(&#39;Mean&#39;, &#39;Median&#39;)
    )
)</code></pre>
<pre><code>##                  Mean       Median
## Raw      9.354230e+03 1.076619e+04
## Imputed  1.039500e+04 1.076619e+04
## % Change 1.509434e-01 3.570839e-02</code></pre>
<pre class="r"><code># 4d. Impact of imputing missing data</code></pre>
</div>
<div id="differences-in-activity-patterns" class="section level3">
<h3>Differences in Activity Patterns</h3>
<pre class="r"><code>library(lattice)

# 1. Create factor variable for Weekend &amp; Weekday
act.daytype &lt;- act %&gt;%
    mutate(weekday = as.factor(
        ifelse(weekdays(date) %in% c(&#39;Saturday&#39;, &#39;Sunday&#39;), &#39;Weekend&#39;, &#39;Weekday&#39;)
    )) %&gt;%
    group_by(weekday, interval) %&gt;%
    summarise(meanSteps = mean(steps, na.rm = TRUE))

# 2. Create plots of average steps on Weekdays &amp; Weekends
xyplot(meanSteps ~ interval | weekday,
       data = act.daytype,
       layout = c(1, 2),
       type = &#39;l&#39;, 
       main = &quot;Weekday vs. Weekend Activity&quot;,
       xlab = &quot;Interval&quot;,
       ylab = &quot;Number of steps&quot;)</code></pre>
<div class="figure">
<img src="PA1_template_files/figure-html/unnamed-chunk-6-1.png" />
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
